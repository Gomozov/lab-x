<script type="text/javascript" charset="utf-8">
  window.onload = function(){
    var canvas = document.getElementById("canvas");     //
    var ctx = canvas.getContext("2d");
    var W = canvas.width;
    var H = canvas.height;
    var degrees = 0;
    var new_degrees = 0;
    var difference = 0;
    var color = "darkturquoise";                         //
    var bgcolor = "#FFF";
    var text;
    var animation_loop, redraw_loop;

    function init() {
      ctx.clearRect(0, 0, W, H);
      ctx.beginPath();
      ctx.strokeStyle = bgcolor;
      ctx.lineWidth = 12;
      ctx.arc(W/2, H/2, 38, 0, Math.PI*2, false); 
      ctx.stroke();
                                       
      var radians = degrees * Math.PI / 180;
      ctx.beginPath();
      ctx.strokeStyle = color;
      ctx.lineWidth = 12;
      ctx.arc(W/2, H/2, 38, 0 - 90*Math.PI/180, radians - 90*Math.PI/180, false); 
      ctx.stroke();
                                                                 
      ctx.fillStyle = color;
      ctx.font = "28px bebas";
      text = Math.floor(degrees/360*100)+"C";
      text_width = ctx.measureText(text).width;
      ctx.fillText(text, W/2 - text_width/2, H/2 + 10);
                    }
    function draw() {
      if(typeof animation_loop != undefined) clearInterval(animation_loop);
      new_degrees = Math.round(Math.random()*360);
      difference = new_degrees - degrees;
      animation_loop = setInterval(animate_to, 1000/difference);
                     }
    function animate_to() {
       if(degrees == new_degrees) clearInterval(animation_loop);
       if(degrees < new_degrees)
         degrees++;
       else
         degrees--;
       init();
                          }
     draw();
     redraw_loop = setInterval(draw, 5000); 
  }
</script>

<div class="row">
  <div class="span9">
    <canvas id="canvas" width="110" height="110">
  </div>
  <div class="span3">
    <%= render 'layouts/user_info' %>
    <br/>
    <%= render 'layouts/fhysical' %>
  </div>
</div>
